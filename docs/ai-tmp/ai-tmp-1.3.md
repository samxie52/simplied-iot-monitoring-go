# Step 1.3: 数据模型设计 - GitHub作品集文档创建指令

## 📋 任务背景
- **项目**: 工业IoT实时数据监控系统 (Go + WebSocket + Kafka架构)
- **当前阶段**: Step 1.3 - 数据模型设计
- **前置条件**: Step 1.2 配置管理系统已完成，统一配置加载和验证机制建立
- **目标受众**: GitHub招聘者、技术面试官、开源社区开发者
- **作品集定位**: 展示企业级数据建模能力、Go语言结构体设计经验、工业IoT领域知识

## 🎯 文档创建要求

请创建一份名为"Step 1.3: 数据模型设计 - 企业级IoT数据结构架构"的技术文档，内容结构必须与以下模板完全一致：

### **第一部分：技术亮点展示** (占文档35%)

1. **项目技术亮点**
   - 明确的技术成就与KPI指标(支持5种传感器类型、10,000+设备建模、完整数据验证体系)
   - 核心技术栈展示(Go Struct、JSON标签、Validator验证、Protocol Buffers兼容)
   - 企业级数据建模能力展示(层次化结构、扩展性设计、向后兼容)
   - 工业IoT领域专业性展示(传感器数据模型、设备状态管理、告警机制)

2. **技术选型与架构设计**
   - 数据序列化方案对比分析表格(JSON vs Protocol Buffers vs MessagePack vs CBOR)
   - 包含性能、可读性、生态支持、跨语言兼容性、推荐指数
   - 数据验证策略对比分析(validator标签 vs 自定义验证 vs JSON Schema)
   - 数据模型设计模式选择(嵌套结构 vs 平铺结构 vs 组合模式)
   - 时间戳和精度处理策略(Unix时间戳 vs RFC3339 vs 高精度时间)

3. **核心架构设计**
   - 数据模型层次架构图(设备→传感器→数据点→元数据)
   - 消息流数据架构图(设备数据→Kafka消息→WebSocket消息→前端展示)
   - 数据验证架构图(结构验证→业务验证→数据清洗→存储)
   - 扩展性设计架构图(版本兼容→字段扩展→类型演化)

### **第二部分：核心实现展示** (占文档45%)

4. **开发实施计划** (总计6天)
   - **第一阶段**(第1-2天): 核心数据模型
     - Step 1.3.1: 设备数据模型设计和结构定义
     - Step 1.3.2: 传感器数据类型和验证规则
   - **第二阶段**(第3-4天): 消息和通信模型
     - Step 1.3.3: Kafka消息格式和序列化设计
     - Step 1.3.4: WebSocket消息模型和路由设计
   - **第三阶段**(第5-6天): 高级特性和集成
     - Step 1.3.5: 告警数据模型和状态管理
     - Step 1.3.6: 数据验证体系和错误处理模型

5. **核心架构设计规范**
   - 设备数据模型架构设计和字段定义规范
   - 传感器数据类型架构设计和精度要求
   - 消息模型架构设计和序列化标准
   - 告警模型架构设计和优先级分类
   - 数据验证规则架构设计和错误定义
   - 时间戳和位置信息标准化设计
   - 完整的数据结构文档和接口规范
   - 关键数据流转换和映射规则（不包含具体实现代码）

6. **技术特性演示**
   - 完整设备数据结构展示和字段说明
   - 多种传感器类型数据格式展示
   - JSON序列化和反序列化效果展示
   - 数据验证和错误处理机制展示
   - 消息路由和类型识别展示

### **第三部分：运维与部署** (占文档10% - 精简版)

7. **数据标准化**
   - 简洁的数据格式标准和命名规范
   - 版本管理和向后兼容性策略
   - 数据迁移和升级方案设计

8. **监控和验证**
   - 数据质量监控指标定义
   - 数据验证失败处理机制
   - 性能监控和序列化效率追踪

### **第四部分：项目成果** (占文档10% - 精简版)

9. **功能演示与测试**
   - 核心数据模型演示预期效果
   - 数据验证测试预期结果展示
   - 序列化性能测试预期数据

10. **GitHub展示要点**
    - 项目亮点总结(企业级数据建模、工业IoT专业性、Go语言最佳实践)
    - 技术能力展示(数据架构设计、结构体设计、验证体系设计)
    - 预期集成效果展示

## 🔧 技术规格要求

### **核心技术栈**
- Go 1.24+, JSON标签, github.com/go-playground/validator/v10
- 时间处理: time.Time, Unix时间戳, RFC3339格式
- 数据验证: 结构体标签验证, 自定义验证函数
- 序列化: encoding/json, 高性能JSON处理

### **完整代码实现指导要求**
- 必须提供详细的数据模型架构设计，让AI能完整实现
- 必须提供完整的结构体定义和字段规范，让AI能完整实现
- 所有设计必须基于项目现有的目录结构
- 架构设计必须为Step 2.1和Step 3.1的集成做好准备
- 包含完整的数据结构、验证规则、方法定义，供AI生成代码时参考

### **设备数据模型规格** (基于README.md)
- **设备标识**: 设备ID、设备型号、固件版本、位置信息
- **传感器数据**: 温度(°C)、湿度(%)、压力(hPa)、开关状态(布尔)、电流(A)
- **设备状态**: 在线状态、信号强度、电池电量、最后通信时间
- **位置信息**: 建筑物、楼层、房间的层次化结构
- **时间戳**: Unix毫秒时间戳、时区信息、数据采集时间

### **消息模型规格**
- **Kafka消息**: 设备数据消息、告警消息、系统状态消息
- **WebSocket消息**: 实时数据推送、客户端订阅、心跳检测
- **消息路由**: 消息类型标识、目标客户端、优先级分类
- **错误处理**: 错误码定义、错误消息、重试机制

### **数据验证规格**
- **结构验证**: 必填字段、数据类型、字段长度限制
- **业务验证**: 数值范围、时间合理性、设备状态一致性
- **数据清洗**: 异常值处理、缺失值填充、数据标准化
- **错误定义**: 验证错误分类、错误级别、处理策略

### **性能目标**
- JSON序列化/反序列化延迟 < 1ms
- 支持每秒100,000+次数据模型操作
- 内存占用优化，单个设备数据结构 < 1KB
- 数据验证处理延迟 < 0.1ms

### **展示重点**
- 专业性: 工业IoT领域的专业数据建模
- 扩展性: 易于扩展的数据结构设计
- 性能: 高效的序列化和验证机制
- 标准化: 企业级数据规范和文档

## 📝 GitHub作品集文档风格要求

### **技术展示性**
- 突出企业级数据建模能力
- 展示Go语言结构体设计的最佳实践
- 包含具体的数据结构设计和验证规则
- 体现对工业IoT领域的深度理解

### **可视化展示**  
- 丰富的数据模型结构图和关系图
- 清晰的数据流转换和映射图
- 直观的验证流程和错误处理图
- 完整的JSON数据格式示例展示

### **简洁专业**
- 重点突出核心数据建模能力
- 运维部分简化，聚焦数据标准化
- 测试部分精简，突出验证机制
- 突出实际可用的企业级数据模型

### **招聘导向**
- 体现后端数据架构设计能力
- 展示Go语言结构体设计经验
- 突出数据验证和错误处理能力
- 体现企业级项目开发经验

## 🎯 特别强调

1. **专业性**: 必须突出工业IoT领域的专业数据建模能力
2. **扩展性**: 重点展示易于扩展和版本兼容的设计理念
3. **标准化**: 详细说明企业级数据规范和文档标准
4. **集成性**: 说明为后续Kafka和WebSocket集成的接口预留
5. **性能**: 体现对高性能数据处理的考虑和优化

## 📋 输出格式要求

请创建一个完整的Markdown文档，文档长度应在6000-8000字之间，确保内容的技术深度和展示效果平衡。文档结构要清晰，多用表格、架构图、设计图等格式丰富内容呈现。

### **📁 代码实现架构规范**
文档必须包含以下详细的架构设计，供AI实现时参考：

1. **Go数据模型架构设计** (基于README.md项目结构)
   ```
   internal/models/                          # 数据模型目录架构设计
   ├── device.go                            # 设备数据模型架构设计
   │   ├── Device结构体                       # 核心设备数据结构
   │   ├── SensorData结构体                  # 传感器数据结构
   │   ├── LocationInfo结构体                # 位置信息结构
   │   ├── DeviceInfo结构体                  # 设备信息结构
   │   └── 数据验证方法定义                   # 验证方法接口设计
   ├── message.go                           # 消息模型架构设计
   │   ├── KafkaMessage结构体                # Kafka消息结构
   │   ├── WebSocketMessage结构体            # WebSocket消息结构
   │   ├── AlertMessage结构体                # 告警消息结构
   │   └── 消息路由方法定义                   # 路由方法接口设计
   ├── alert.go                             # 告警模型架构设计
   │   ├── Alert结构体                       # 告警数据结构
   │   ├── AlertRule结构体                   # 告警规则结构
   │   └── AlertStatus枚举                   # 告警状态定义
   └── common.go                            # 通用数据类型设计
       ├── Timestamp类型                     # 时间戳类型定义
       ├── 错误类型定义                       # 自定义错误类型
       └── 常量定义                          # 系统常量定义
   ```

2. **数据验证架构设计**
   ```
   # validator标签规范和自定义验证函数设计
   # 数据清洗和标准化处理机制设计
   # 错误处理和错误码定义体系设计
   # 数据类型转换和兼容性处理设计
   ```

3. **序列化和接口设计**
   ```
   # JSON序列化标签和字段映射规范
   # 接口定义和方法签名设计
   # 数据转换和适配器模式设计
   # 版本兼容和字段演化策略设计
   ```

4. **集成接口设计**
   ```
   # 为Step 2.1 Kafka生产者预留的数据接口设计
   # 为Step 3.1 WebSocket服务预留的消息接口设计
   # 数据模型转换和映射接口设计
   ```

### **架构设计详细程度要求**
- 提供详细的结构体定义和字段规范
- 提供完整的数据验证规则和方法签名
- 提供详细的JSON标签和序列化规范
- 提供消息路由和类型识别的详细机制
- 提供错误处理和状态管理的详细设计
- **不包含具体的代码实现，只包含设计规范和接口定义**

### **数据模型设计标准** (基于README.md定义)
```json
{
  "device_id": "device_001",
  "timestamp": 1640995200000,
  "location": {
    "building": "A栋",
    "floor": 3,
    "room": "301"
  },
  "sensors": {
    "temperature": {
      "value": 25.6,
      "unit": "°C",
      "status": "normal"
    },
    "humidity": {
      "value": 65.2,
      "unit": "%",
      "status": "normal"
    },
    "pressure": {
      "value": 1013.25,
      "unit": "hPa",
      "status": "normal"
    },
    "switch_status": {
      "value": true,
      "status": "on"
    },
    "current": {
      "value": 2.5,
      "unit": "A",
      "status": "normal"
    }
  },
  "device_info": {
    "model": "IOT-SENSOR-V2",
    "firmware": "1.2.3",
    "battery": 85,
    "signal_strength": -45
  }
}
```

### **告警数据模型标准** (基于README.md定义)
```json
{
  "alert_id": "alert_20240130_001",
  "device_id": "device_001",
  "alert_type": "temperature_high",
  "severity": "high",
  "message": "设备温度超过阈值 (当前: 85.2°C, 阈值: 80°C)",
  "timestamp": 1640995200000,
  "status": "active",
  "threshold": {
    "parameter": "temperature",
    "operator": ">",
    "value": 80.0
  },
  "current_value": 85.2
}
```

重点包含：
- 系统架构图和数据模型关系图
- **详细的架构设计和接口规范** (供AI实现代码时参考)
- 数据结构设计预期效果展示
- 验证机制预期展示
- 项目技术亮点总结

最后，在文档末尾添加：
- GitHub项目展示要点总结
- 数据建模技术栈掌握程度说明
- **完整的架构设计总结** (供AI生成代码时参考)
- **代码实现清单和规范** (每个模型的实现要求)
- 下一步集成方向(Step 2.1预览)

### **🎯 文档与代码分离要求**
生成的1.3.md架构文档必须确保：
1. ✅ **只包含架构设计，不包含具体代码实现**
2. ✅ 包含足够详细的接口定义，让AI能根据文档完整实现代码
3. ✅ 所有设计基于README.md中定义的项目结构和数据格式
4. ✅ 架构设计与Step 1.2配置管理系统正确集成
5. ✅ 包含完整的数据结构和验证规范
6. ✅ 提供清晰的实现指导，但不提供具体实现

### **📋 后续代码生成说明**
基于此1.3.md架构文档，AI应该能够：
- 根据结构体设计生成完整的Go数据模型代码
- 根据验证规范生成完整的数据验证代码
- 根据接口定义生成完整的方法实现代码
- 根据消息模型生成完整的序列化代码
- 根据告警设计生成完整的告警处理代码

### **🏗️ 数据模型层次设计**
```
IoT设备数据模型层次:
┌─────────────────────────────────────────┐
│               Device (设备)              │
├─────────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────────────┐ │
│ │ DeviceInfo  │ │    LocationInfo     │ │
│ │ (设备信息)   │ │    (位置信息)        │ │
│ └─────────────┘ └─────────────────────┘ │
├─────────────────────────────────────────┤
│               SensorData (传感器数据)     │
│ ┌─────────┬─────────┬─────────┬─────────┐ │
│ │Temperature│Humidity│Pressure │Current  │ │
│ │  (温度)   │ (湿度)  │ (压力)  │ (电流)  │ │
│ └─────────┴─────────┴─────────┴─────────┘ │
└─────────────────────────────────────────┘
```

现在请开始创建这份面向GitHub作品集的Step 1.3**架构设计文档**，确保AI后续能根据此文档完整实现所有数据模型代码和企业级IoT数据结构。